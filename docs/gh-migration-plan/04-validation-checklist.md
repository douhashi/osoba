# 検証チェックリスト

## 概要
internal/ghへの移行が完全に成功したことを確認するための包括的なチェックリスト。

## 実装完了チェックリスト

### メソッド実装状況

#### 基本機能（既存実装の検証）
- [ ] GetRepository
  - [ ] 正常系動作確認
  - [ ] エラーハンドリング
  - [ ] テスト通過
- [ ] ListIssuesByLabels
  - [ ] 単一ラベル検索
  - [ ] 複数ラベル検索
  - [ ] 空の結果処理
- [ ] ListAllOpenIssues
  - [ ] ページネーション
  - [ ] 大量Issue処理
  - [ ] タイムアウト処理
- [ ] GetRateLimit
  - [ ] レート情報取得
  - [ ] 残量計算
  - [ ] リセット時刻
- [ ] TransitionIssueLabel
  - [ ] ラベル遷移ロジック
  - [ ] 状態管理
  - [ ] エラー時の復元
- [ ] TransitionIssueLabelWithInfo
  - [ ] 詳細情報の返却
  - [ ] ログ記録
  - [ ] 監査証跡
- [ ] EnsureLabelsExist
  - [ ] ラベル作成
  - [ ] 既存ラベル確認
  - [ ] 色・説明の設定
- [ ] CreateIssueComment
  - [ ] コメント投稿
  - [ ] マークダウン対応
  - [ ] 文字数制限
- [ ] RemoveLabel
  - [ ] ラベル削除
  - [ ] 存在しないラベル処理
  - [ ] 権限エラー
- [ ] AddLabel
  - [ ] ラベル追加
  - [ ] 重複ラベル処理
  - [ ] ラベル上限確認

#### 新規実装（PR関連機能）
- [ ] GetPullRequestForIssue
  - [ ] GraphQL検索
  - [ ] フォールバック検索
  - [ ] ブランチパターン検索
  - [ ] 複数PR対応
- [ ] MergePullRequest
  - [ ] マージ可能性確認
  - [ ] マージ実行
  - [ ] コンフリクト処理
  - [ ] CI待機
- [ ] GetPullRequestStatus
  - [ ] 状態取得
  - [ ] レビュー状態
  - [ ] CI状態
  - [ ] マージ可能性
- [ ] ListPullRequestsByLabels
  - [ ] ラベルフィルタ
  - [ ] 複合条件
  - [ ] ソート順
  - [ ] ページネーション
- [ ] GetClosingIssueNumber
  - [ ] API取得
  - [ ] 本文パース
  - [ ] 複数Issue対応
  - [ ] 記法バリエーション
- [ ] TransitionLabels
  - [ ] 原子的操作
  - [ ] ロールバック
  - [ ] 並行制御
  - [ ] デッドロック回避

## テスト検証チェックリスト

### テストカバレッジ
- [ ] 全体カバレッジ 85%以上
- [ ] コア機能カバレッジ 95%以上
- [ ] PR機能カバレッジ 90%以上
- [ ] エラー処理カバレッジ 80%以上

### テスト移行状況
- [ ] 76個のテストすべて移行完了
- [ ] 全テスト成功（グリーン）
- [ ] テスト実行時間が許容範囲内（< 5分）
- [ ] 並列実行可能

### テスト品質
- [ ] フレーキーテストなし
- [ ] モック実装の完全性
- [ ] エッジケーステスト
- [ ] 境界値テスト

## パフォーマンス検証

### 実行速度
- [ ] API呼び出し回数の最小化
- [ ] 並列処理の活用
- [ ] キャッシュ効果の測定
- [ ] タイムアウト設定の妥当性

### リソース使用
- [ ] メモリ使用量が許容範囲内
- [ ] CPU使用率の監視
- [ ] ネットワーク帯域の効率化
- [ ] プロセス数の制御

### ベンチマーク結果
```
操作                   internal/github  internal/gh   差異
ListIssues (100件)     1.2s            1.5s         +25%
GetPR                  0.3s            0.4s         +33%
MergePR                0.8s            0.9s         +12%
TransitionLabels       0.5s            0.7s         +40%
```
- [ ] パフォーマンス劣化が20%以内

## 互換性検証

### API互換性
- [ ] メソッドシグネチャの完全一致
- [ ] 戻り値の型の一致
- [ ] エラー型の互換性
- [ ] nil処理の一貫性

### 動作互換性
- [ ] 同一入力で同一出力
- [ ] エラーメッセージの一貫性
- [ ] タイムアウト動作の一致
- [ ] リトライ動作の一致

### 後方互換性
- [ ] 既存コードの動作保証
- [ ] 設定ファイルの互換性
- [ ] 環境変数の互換性
- [ ] ログフォーマットの維持

## セキュリティ検証

### 認証・認可
- [ ] ghコマンド認証の確認
- [ ] トークン管理の安全性
- [ ] 権限昇格の防止
- [ ] アクセス制御の確認

### データ保護
- [ ] 機密情報のマスキング
- [ ] ログへの出力制御
- [ ] 一時ファイルの安全な削除
- [ ] メモリ上のデータ保護

### 脆弱性対策
- [ ] コマンドインジェクション対策
- [ ] パストラバーサル対策
- [ ] DoS攻撃対策
- [ ] レート制限の実装

## 統合検証

### システム統合
- [ ] Watcherシステムとの統合
- [ ] アクション実行の確認
- [ ] ラベル遷移の動作
- [ ] PR自動処理の確認

### CI/CD統合
- [ ] GitHub Actions動作確認
- [ ] テスト自動実行
- [ ] カバレッジレポート生成
- [ ] デプロイプロセス確認

### モニタリング
- [ ] ログ出力の確認
- [ ] メトリクス収集
- [ ] アラート設定
- [ ] ダッシュボード更新

## ドキュメント検証

### コードドキュメント
- [ ] GoDocコメントの完全性
- [ ] 使用例の提供
- [ ] エラー処理の説明
- [ ] パラメータの説明

### ユーザードキュメント
- [ ] README更新
- [ ] 移行ガイド作成
- [ ] API リファレンス
- [ ] トラブルシューティングガイド

### 開発者ドキュメント
- [ ] アーキテクチャ図更新
- [ ] 設計判断の記録
- [ ] テスト戦略の文書化
- [ ] パフォーマンス分析

## 最終確認チェックリスト

### リリース前確認
- [ ] 全チェック項目の完了
- [ ] ステークホルダーレビュー
- [ ] セキュリティレビュー
- [ ] パフォーマンステスト合格

### 移行実施
- [ ] バックアップ作成
- [ ] 段階的ロールアウト開始
- [ ] モニタリング強化
- [ ] ロールバック準備

### 移行後確認
- [ ] 本番環境動作確認
- [ ] パフォーマンス監視
- [ ] エラー率監視
- [ ] ユーザーフィードバック収集

### internal/github削除
- [ ] 依存関係の最終確認
- [ ] コード削除
- [ ] テスト削除
- [ ] ドキュメント更新

## サインオフ

### 技術承認
- [ ] 開発チームリード承認
- [ ] アーキテクト承認
- [ ] セキュリティチーム承認
- [ ] QAチーム承認

### ビジネス承認
- [ ] プロダクトオーナー承認
- [ ] プロジェクトマネージャー承認

### 完了宣言
- [ ] 移行完了の公式発表
- [ ] リリースノート公開
- [ ] チーム通知
- [ ] 祝賀会の開催 🎉

---

## 付録: トラブルシューティング

### よくある問題と対処法

#### ghコマンドが見つからない
```bash
# インストール確認
which gh

# インストール
brew install gh  # macOS
sudo apt install gh  # Ubuntu
```

#### 認証エラー
```bash
# 認証状態確認
gh auth status

# 再認証
gh auth login
```

#### API制限エラー
```bash
# レート制限確認
gh api rate_limit

# 待機またはトークン変更
```

#### タイムアウトエラー
```go
// タイムアウト設定の調整
ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
defer cancel()
```